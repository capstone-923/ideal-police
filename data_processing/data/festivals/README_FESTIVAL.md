# Scripts & Processed Festival Data

This repository contains scripts for downloading, processing, and analyzing Toronto's general festival data of both 2014-2016 and 2017 festivals and events onward. Most of data files can be found in the [Google Drive folder](https://drive.google.com/drive/folders/1esWev9RbiMcrsVrJNU8vd6m4UDqvDcze).

---

## Folder Overview
- Requires installation of `pandas`
  - In Command Window, install pandas module using the command `pip install pandas`
  - Please ensure pandas is installed. 
- Originally, all codes are run inside Google Colab. So suggest running the codes there. 
- Replace all path leading to the data files the user want to process. 

#### **`url_download.py`**:
- The python script creates a resources_metadata.json that stores all three types of dataset contained in Toronto Open Data Portal for festival datasets. 
  - **festivals-and-events-historical-xml-feed-jan-2014-dec-2016**
  - **festivals-and-events-readme**
  - **Festivals and events json feed**
- The `festivals-and-events-readme` is a README file for the categories' abbreviation in the `festivals-and-events-historical-xml-feed-jan-2014-dec-2016` and `Festivals and events json feed`
- The `festivals-and-events-historical-xml-feed-jan-2014-dec-2016` dataset contain all festival events from 2014 to 2016 in xml format.
- The `Festivals and events json feed` contain all registered festival events from today into future in json format. 

### **1. `2014_2016_festival_toronto_open_data`**
- Please use the scripts in the order of the top right commented number.

#### **`2014_2016_cleaning.py`**:
- This python file converts `festivals-and-events-historical-xml-feed-jan-2014-dec-2016`'s XML format into CSV format useable for this project.
- The CSV file generated by this program will be feed into `2014_2016_process.py` for more detailed filtering. 
- The files are not combined for debugging purposes. 

#### **`2014_2016_process.py`**:
- This python file processed the CSV file extracted using `2014_2016_cleaning.py` and output a CSV dataset useable for extracting numbers of the categorical data. 

#### **`categorization&mapping_neighborhood.py`**:
- This python file processed the CSV file outputted from `2014_2016_process.py`. 
- This file locates the neighborhood in where the events take place. It then counts the number of events each neighborhood hold in each day. 

### **2. `future_toronto_open_data_portal`**
- This folder contains Python scripts to download festival data after 2017 into the future.
- This folder processes data from `Festivals and events json feed` sub-dataset from the `Festival and Events` dataset from Toronto Open Data Portal. The `Festivals and events json feed` only contain registered events of current day and those in the future. It does not contain past events. Thus, the team imports data from archived webpage of the Toronto Open Data portal. 
  - Two sources of archived webpage are: 
    - Toronto Open Data Portal's archive (https://wayback.archive-it.org/3608/*/http://www1.toronto.ca/wps/portal/contentonly?vgnextoid=8e79f9be8db1c310VgnVCM1000006cd60f89RCRD)
    - Wayback Machine's Archive (https://web.archive.org/web/20240000000000*/https://www.toronto.ca/)
  - Datasets from nearby timestamps are compared and concatenated; duplicated entries are subtracted. 

- Please use the scripts in the order of the top right commented number.

#### **`onward_extraction.py`**:
- This python file contains the basic function to extract past json feed from archived Toronto Open Data Portal. 
- However, there is no automation for entering the URL from which the feeds are from as it depends on which timestamp is available in the archive. The user will need to manually change the url. 
- The data extraction procedure works with the user downloading datasets in a chronological order. 
  - Downloading Dataset from 2017 March first, then 2017 June, then 2017 Sept....
  - Please change the value of variable `data_month`, `data_year`,`previous_month`,`previous_year` when downloading dataset from a new url. These variables will be used for later data processing. 

#### **`onward_processing`**:
- This python file takes the json file outputted from `onward_extraction.py` and converts it into a cleaner CSV file. 

#### **`onward_cat.py`**:
- This python file assumes the user have converted all past json feed from the archived websites into corresponding CSV files and stored them in one folder. 
- This python file will take the folder's path and concatenate all stored CSV in the folder and output one CSV file. 

## Downloadable Processed Data Overview

### **1. `final_cleaned_2014_2016`**
- This is an intermediate dataset output by `separation_cat_noncat` function in `categorization&mapping_neighborhood`script. 
- After the uncategorized event have categories added and concatenated with this dataset, the entire dataset can be used for correlation analysis. 
- This dataset can be downloading in the Google Drive, following this link: https://drive.google.com/file/d/1DoM4JLbr9mF5KdwTJz9X33VTUquzOulR/view?usp=drive_link

- 
| Header              | Meaning                                                                                     |
|---------------------|---------------------------------------------------------------------------------------------|
| EventName           | Name of the event.                                                                         |
| Area                | Region of the city where the event was held.                                               |
| CategoryList        | Categories associated with the event (e.g., sports, music).                                |
| TimeBegin           | Time when the event starts.                                                                |
| start_day           | Day when the event starts.                                                                 |
| start_month         | Month when the event starts.                                                               |
| start_year          | Year when the event starts.                                                                |
| TimeEnd             | Time when the event ends.                                                                  |
| end_day             | Day when the event ends.                                                                   |
| end_month           | Month when the event ends.                                                                 |
| end_year            | Year when the event ends.                                                                  |
| Admission           | Information about event admission fees (e.g., free, ticketed).                            |
| LongDesc            | Detailed description of the event.                                                         |
| Location            | Location where the event is held (e.g., venue name).                                       |
| Intersection        | Nearest major intersection to the event location.                                          |
| TTC                 | Indicates if the location is accessible by Toronto Transit Commission (TTC) transit.      |
| AccessibleFully     | Indicates if the event location is fully accessible for people with disabilities.          |
| ParkingFree         | Indicates if free parking is available at the event location.                              |
| PublicWashrooms     | Indicates if public washrooms are available at the event location.                         |
| AccessiblePartially | Indicates if the event location is partially accessible for people with disabilities.      |
| ParkingPaid         | Indicates if paid parking is available at the event location.                              |
| FoodBeverage        | Indicates if food and beverages are available at the event location.                       |
| Shopping            | Indicates if shopping facilities are available at the event location.                      |
| KidFriendly         | Indicates if the event is suitable for children.                                           |
| History             | Indicates if the event has historical significance.                                        |
| Green               | Indicates if the event promotes environmentally friendly practices.                        |
| NewThisYear         | Indicates if the event is new for the current year.                                        |
| Reservations        | Indicates if reservations are required to attend the event.                                |
| OfficialGreenSite   | Indicates if the event location is an officially designated green site.                    |
| BikeRacks           | Indicates if bike racks are available at the event location.                               |
| RoadClose           | Indicates if roads are closed for the event.                                               |
| OrganicFood         | Indicates if organic food options are available at the event location.                     |
| Address             | Full address of the event location.                                                        |
| $6                  | Admission cost (specific to events with a $6 fee, if applicable).                          |
| txtLong             | Longitude of the event location.                                                           |
| txtLat              | Latitude of the event location.                                                            |
| start_date          | Combined start date of the event (derived from start_day, start_month, start_year).        |
| end_date            | Combined end date of the event (derived from end_day, end_month, end_year).                |

### **1. `final_cleaned_2014_2016`**
- Dataset can be downloaded from: https://drive.google.com/file/d/1IdnEHELaOLWMtUHGXUYMfv-sAAAcjhUi/view?usp=drive_link.
- Based on all available archived Toronto Open Data Portal's Festival and Event Dataset, we created a encoded dataset covering events from 2016 Feburary 10 to 2020 March 16, as of the last archived webpage dated on 2019 September. 
- This dataset is ready to be used for correlation analysis. 

| Header                       | Meaning                                                                                     |
|------------------------------|---------------------------------------------------------------------------------------------|
| neighborhood                 | Name of the neighborhood where the events occurred.                                         |
| year                         | Year when the events took place.                                                           |
| month                        | Month when the events occurred.                                                            |
| day                          | Day when the events occurred.                                                              |
| total_events                 | Total number of events recorded in the neighborhood on that date.                          |
| Live_Performances            | Count of live performance events (e.g., concerts, theater shows).                          |
| Arts/Exhibits                | Count of art exhibitions or similar events.                                                |
| Seminars/Workshops           | Count of seminars or workshops held.                                                       |
| Exercise                     | Count of exercise-related events (e.g., yoga, fitness sessions).                           |
| Street_Festival              | Count of street festival events.                                                           |
| Sports_Game_To_Watch         | Count of events related to watching sports games.                                           |
| Celebrations/Holiday         | Count of celebration or holiday-related events.                                            |
| free_events                  | Count of events that were free to attend.                                                  |
